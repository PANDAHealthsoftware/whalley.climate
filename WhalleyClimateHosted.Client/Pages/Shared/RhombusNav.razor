@using WhalleyClimateHosted.Client.Models
@using Microsoft.AspNetCore.Components

<div class="rhombus-wrapper">
    <ul class="rhombus-nav" role="tablist">
        @for (int i = 0; i < Tabs.Count; i++)
        {
            var idx = i;  @* capture loop index *@
            <li @key="idx"
                class="@(idx == ActiveIndex ? "current" : null)"
                role="tab"
                tabindex="@(idx == ActiveIndex ? 0 : -1)"
                aria-selected="@(idx == ActiveIndex)">
                <a href="#"
                   @onclick="() => OnClick(idx)"
                   @onclick:preventDefault="true">
                    <span>@Tabs[idx].Title</span>
                </a>
            </li>
        }
    </ul>
</div>

@code {
    [Parameter, EditorRequired] public List<TabItem> Tabs { get; set; } = default!;
    [Parameter] public int ActiveIndex { get; set; }
    [Parameter] public EventCallback<int> ActiveIndexChanged { get; set; }

    private Task OnClick(int idx)
    {
        idx = Math.Clamp(idx, 0, Tabs.Count - 1);
        return ActiveIndexChanged.InvokeAsync(idx);
    }
}